---
- name: Sublime - exists
  stat: path=/usr/bin/subl
  register: sublime

- name: Sublime - download
  become_user: "{{ user }}"
  get_url:
    url=https://download.sublimetext.com/sublime-text_build-3103_amd64.deb
    dest="{{ download_path }}/sublime_text.deb"
  when: not sublime.stat.exists

- name: Sublime - install
  apt: deb="{{ download_path }}/sublime_text.deb"
  when: not sublime.stat.exists

- name: Sublime - config path
  become_user: "{{ user }}"
  file:
    path="{{ home_dir }}/.config/sublime-text-3"
    state=directory
    mode=0775
  when: not sublime.stat.exists

- name: Sublime - symlinks to dropbox
  become_user: "{{ user }}"
  file:
    src="{{ home_dir }}/Dropbox/Sublime/{{ item }}"
    dest="{{ home_dir }}/.config/sublime-text-3/{{ item }}"
    state=link
  with_items:
    - Packages
    - Installed Packages
